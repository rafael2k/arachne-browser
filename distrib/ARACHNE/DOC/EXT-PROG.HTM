<HTML>
<HEAD><TITLE>external trix</TITLE></HEAD>
<BODY BGCOLOR=#BBFFFF TEXT=#000000 LINK=BLUE>

<H1>Using external programs with Arachne</H1>
<B><HR>
<H2>But why use an external program?</H2>
<UL><LI>To use your own favorite text processor, image viewer, or ....</LI>
<LI>To perform a task Arachne can not handle</LI></UL><HR>
Arachne understands five basic file types: HTM, GIF, BMP, TXT and ASF. <BR>
If the file has a different extension than one of those and <FONT COLOR=RED>
if</FONT> in the conversion table in <FONT COLOR=RED> mime.cfg </FONT>no
corresponding action is defined, Arachne offers:<BR> moving the downloaded file
from the CACHE directory (or of a local file) to the DOWNLOAD directory...
than you can do anything you want with that file.<BR>You may even transport
it to another computer.<BR>
</B>(ASF files are treated as script files (simply lists of URLs).<B>
<P>
A very often used format is .JPG, but only .GIF and .BMP can be inlined
using the IMG-tag in HTML documents. Arachne uses some built in
conversion programmes to view eg. .JPG images.<BR>
Such programmes have to be declared in <FONT COLOR=RED>mime.cfg</FONT>!<BR>
</B>JPG can be converted to BMP (Arachne default) or to GIF (my choice)...
just change the declaration in mime.cfg<B>
<HR>
<H1>External »» internal</H1>
External programs can be placed into Arachne, making them internal progs.
<HR>
<H2><U>Example</U></H2>
Texts generated by M$ WORD can not be viewed with Arachne, so we have
to use a special program to view a WORD text (.doc) with DOS.<P>
I use the DOS program: view.exe<BR>

View.exe is a small program that can be placed in the \Arachne directory.
It can be automaticaly activated by Arachne on every occurence of the .doc
extension by adding the following line to mime.cfg:<PRE>
file/.doc   |@$view.exe $l ($l = letter "l" means last visited file)</PRE><BR>
<B>
This has a disadvantage...<BR> If a .doc extension is encountered than view.exe
is showing the file ;-) but you can not save the original word file with F2.
However, you can find the original file in your cache and save it from there.
This is not very practical... <P>
If Arachne encounters an extension <FONT COLOR=RED>not </FONT>declared in mime.cfg the
"Arachne does not know how to handle following file type:"
screen is showed. I modified this screen to have the opportunity to view
a Word file and save the original. (The CACHE is not a save place to store
 any file.) <BR>View.exe may save your file in .TXT format or even print
it. See the change at the right: VIEW.EXE is added.<P>

<IMG SRC="savetrix.gif" WIDTH=620><P>

To change the "Arachne does not know.." page: just press F4 to edit the
page if the page is on your monitor.<P>The </B>
&#60;FORM ACTION="view.dgi"&#62;&#60;INPUT TYPE="SUBMIT" VALUE="VIEW.EXE"&#62;
<B> button should be added. <INPUT TYPE="SUBMIT" VALUE="VIEW.EXE"><P>

In the HTML tags for this button FORM ACTION is pointing to: view.dgi thus view.dgi has to be defined in
mime.cfg. The file/.doc declaration, if already made, should be removed
or altered into: file/view.dgi  |@$view.exe $l<BR>
Now you can save <FONT COLOR="RED">and </FONT>view your Word file.
<H2><U>Other example</U></H2>
In Arachne version 171.ue Glenn McCorkle introduced "ZBM". ZBM = Zipped BMP.<BR>
Since a BMP image is very large, to store and to send, the BMP is zipped
before it is saved in order to make it much smaller.<BR>
The zipping is provoked by pressing F2 (save). An extra button is added to
the "save screen" in the same way as already has been shown above.<BR>
The ZIP programs "PKZIP.exe" and "PKUNZIP.exe" (for viewing a ZBM) should
be placed into Arachne. Also viewing and saving ZBM should be declared in
mime.cfg.

<HR>
<H1>Real external programmes</H1><HR>
<H3><u>Example: Norton Commander</U></H3>

One of the programs I wanted to use is Norton Commander (NC) in the C:\NORTON directory.
<H3>Method #1</H3>
By pressing Alt E you are leaving Arachne and the return is by typing
the DOS command EXIT.
A simple way to use NC is:<BR><UL>
<LI>Press: Alt+E and you are leaving Arachne for the external program</LI>
<LI>Type: CD C:\ or C:\NORTON\nc at the DOS prompt</LI></UL>
Now you are in Norton Commander and can use it!<P>

After you have done your things... press F10 [+ enter] to leave Norton<BR>
Now type: EXIT at the DOS prompt and you are back to Arachne... but not
back at the point you left Arachne ;-((

<H3>Method #2</H3>
Alt E invokes 'dosshell.dgi'. I could not find a file or program called
dosshell.dgi but in \system\dgi there is a batch file: dosshell.bat and
some other programs like: fixmem.exe, wizard.exe, etc.<BR>
I suppose these progs execute within Arachne?<P>

Why not make a batch file in \system\dgi that shells out to Norton
commander? I called it 'norton.bat'.<BR>
Giving the command, the URL, file:norton.dgi does not start NC (to my
surprise)... a dgi script has to be declared in mime.cfg first.<BR>

After adding the following line to mime.cfg it worked.<BR>
<PRE>file/norton.dgi     |@call $esystem\\dgi\\norton.bat $e</PRE><B><BR>

Of course there is no hot key assigned to NC but:<BR>
*  A HREF="norton.dgi" can be used in a HTML script<BR>
*  With F3: </B>file:norton.dgi<B> can be used<BR>
*  </B>ShiftF10 file:norton.dgi<B> in arachne.cfg makes Shift+F10 a hot key for NC<BR>
*  The NC icon was added to the F10 Arachne "desk top" page<BR>
<P>
Now all was going well, except that after leaving NC there was no
return to the place where I left Arachne. The push and pop commands were added to the batch
file 'norton.bat' in the \system\dgi directory.<BR>
Now all is functioning the way I wanted it to.<BR></B>

[pop.com and push.com should be added to Arachne]<BR>
<P>
<B>The batch file 'norton.bat'.
<PRE>
push
@echo off
C:\norton\nc
pop
EXIT</PRE>
<BR><B><P>

Although this might not be the easiest way to call an external program
and return to Arachne, it works great!<BR>
My F2 button has been extended to call PICTURE VIEW as an external program
too. PV can be used to view or convert (nearly) any image format into
another... or print the image.
<HR>
<H1>Arachne Package Manager</H1>
Another way of adding programmes to Arachne. See the Arachne HELP files,
by pressing F1.
<HR>
<FONT COLOR=RED>Now you schould be able to roll your own...</FONT><BR>
Regards, Bastiaan<BR></B>
This file: ext-prog.htm also used: savetrix.gif


</BODY>
</HTML>
